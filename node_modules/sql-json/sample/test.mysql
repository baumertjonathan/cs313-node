CREATE TABLE `Endpoints` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `userId` int(11) NOT NULL,
  `projectId` int(11) NOT NULL,
  `resourcePath` varchar(255) NOT NULL,
  `version` varchar(45) NOT NULL,
  `method` enum('GET','POST','PUT','DELETE') NOT NULL,
  PRIMARY KEY (`id`),
  KEY `fk_endpoints_user_idx` (`userId`),
  KEY `fk_endpoints_project_idx` (`projectId`),
  CONSTRAINT `fk_endpoints_project` FOREIGN KEY (`projectId`) REFERENCES `Projects` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `fk_endpoints_user` FOREIGN KEY (`userId`) REFERENCES `Users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=32 DEFAULT CHARSET=utf8;

CREATE TABLE `HostNames` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `userId` int(11) NOT NULL,
  `projectId` int(11) NOT NULL,
  `hostName` varchar(256) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `fk_user_idx` (`userId`),
  KEY `fk_project_idx` (`projectId`),
  CONSTRAINT `fk_hostnames_project` FOREIGN KEY (`projectId`) REFERENCES `Projects` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `fk_hostnames_user` FOREIGN KEY (`userId`) REFERENCES `Users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8;

CREATE TABLE `Middleware` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `endpointId` int(11) NOT NULL,
  `middlewareTypeId` int(11) NOT NULL,
  `parameters` varchar(1024) NOT NULL,
  `order` int(11) NOT NULL DEFAULT '0',
  PRIMARY KEY (`id`),
  KEY `fk_middleware_endpoint_idx` (`endpointId`),
  KEY `fk_middleware_middlewareType_idx` (`middlewareTypeId`),
  CONSTRAINT `fk_middleware_endpoint` FOREIGN KEY (`endpointId`) REFERENCES `Endpoints` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION,
  CONSTRAINT `fk_middleware_middlewareType` FOREIGN KEY (`middlewareTypeId`) REFERENCES `MiddlewareTypes` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=30 DEFAULT CHARSET=utf8;

CREATE TABLE `MiddlewareTypes` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `scheme` enum('git','file') NOT NULL DEFAULT 'git',
  `name` varchar(255) NOT NULL,
  `version` varchar(45) NOT NULL DEFAULT '1.0',
  `schema` text,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8;

CREATE TABLE `Projects` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `userId` int(11) NOT NULL,
  `name` varchar(45) DEFAULT NULL,
  `settings` text,
  PRIMARY KEY (`id`),
  KEY `fk_user_idx` (`userId`),
  CONSTRAINT `fk_projects_user` FOREIGN KEY (`userId`) REFERENCES `Users` (`id`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8;

CREATE TABLE `Users` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `name` varchar(45) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=4 DEFAULT CHARSET=utf8;
